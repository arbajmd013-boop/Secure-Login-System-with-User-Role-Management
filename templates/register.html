{% extends "base.html" %}

{% block title %}Register | SecureAuth{% endblock %}

{% block content %}
<section class="card">
  <h1>Create Account</h1>
  <p class="subtitle">Public registration creates a standard user account only.</p>

  <form id="register-form" method="post" class="form-grid" novalidate>
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

    <label for="username">Username</label>
    <input
      id="username"
      name="username"
      type="text"
      required
      minlength="3"
      maxlength="30"
      pattern="[A-Za-z0-9_]+"
      placeholder="john_doe"
    />

    <label for="email">Email</label>
    <input id="email" name="email" type="email" required placeholder="you@example.com" />

    <label for="password">Password</label>
    <div class="password-field">
      <input id="password" name="password" type="password" required minlength="12" />
      <button
        type="button"
        class="password-toggle"
        data-target="password"
        aria-label="Show password"
        aria-pressed="false"
      >
        <span class="eye-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </span>
        <span class="eye-off-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M4 20L20 4"></path>
          </svg>
        </span>
      </button>
    </div>
    <small class="hint">
      12+ chars, uppercase, lowercase, number, symbol.
    </small>

    <label for="confirm_password">Re-enter Password</label>
    <div class="password-field">
      <input id="confirm_password" name="confirm_password" type="password" required minlength="12" />
      <button
        type="button"
        class="password-toggle"
        data-target="confirm_password"
        aria-label="Show re-enter password"
        aria-pressed="false"
      >
        <span class="eye-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </span>
        <span class="eye-off-icon" aria-hidden="true">
          <svg viewBox="0 0 24 24" focusable="false">
            <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6S2 12 2 12z"></path>
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M4 20L20 4"></path>
          </svg>
        </span>
      </button>
    </div>
    <small class="hint">
      Must exactly match Password.
    </small>

    <button class="btn btn-primary" type="submit">Register</button>
  </form>

  <p class="hint">Already registered? <a href="{{ url_for('main.login') }}">Login here</a>.</p>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/validation.js') }}"></script>
<script src="{{ url_for('static', filename='js/password_toggle.js') }}"></script>
{% endblock %}
